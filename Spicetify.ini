[Rainmeter]
Update = 1000
ContextTitle = New theme
ContextAction = !CommandMeasure Script ThemeNew()
ContextTitle2 = Duplicate current theme
ContextAction2 = !CommandMeasure Script ThemeDuplicate()
[Variables]
CurrentTheme =SpicetifyDefault
@include = #ROOTCONFIGPATH#Themes\#CurrentTheme#\color.inc

Replace_Colors =1
Hide_Ads =1
Inject_CSS =1

[Script]
Measure = Script
ScriptFile = #@#Script.lua

[Backup]
Measure = Plugin
Plugin = RunCommand
Parameter = robocopy "%appdata%\Spotify\Apps" "#@#Backup"
OutputType = ANSI
FinishAction = !CommandMeasure Script "Init_Unzip()"

[Restore]
Measure = Plugin
Plugin = RunCommand
Parameter = robocopy "#@#Backup" "%appdata%\Spotify\Apps"
OutputType = ANSI
FinishAction = [!CommandMeasure Script "status='Restore succeeded'"]["#@#AutoRestart.exe"]

[ClearBackup]
Measure = Plugin
Plugin = RunCommand
Parameter = RD "#@#Backup" /S /Q
OutputType = ANSI
FinishAction = [!CommandMeasure ClearBackup2 "Run"][!CommandMeasure Script "status='Backup cleared'"]

[ClearBackup2]
Measure = Plugin
Plugin = RunCommand
Parameter = RD "#@#Extracted" /S /Q
OutputType = ANSI
FinishAction = [!Refresh]

[Unzip]
Measure = Plugin
Plugin = RunCommand
Program = "#@#7z.exe"
StartInFolder = #@#
OutputType = ANSI
DynamicVariables = 1
FinishAction = !CommandMeasure "Script" "DuplicateExtracted()"

[Duplicate]
Measure = Plugin
Plugin = RunCommand
OutputType = ANSI
StartInFolder = #@#Extracted
FinishAction = !CommandMeasure "Script" "Init_PrepareCSS()"

[Zip]
Measure = Plugin
Plugin = RunCommand
Program = "#@#7z.exe"
StartInFolder = #@#Decomp
OutputType = ANSI
DynamicVariables = 1
FinishAction = !CommandMeasure "Remove" "Run"

[Remove]
Measure = Plugin
Plugin = RunCommand
Parameter = "del #@#Decomp\css /Q"
OutputType = ANSI
FinishAction = !CommandMeasure "Script" "ModSpa()"

[Replicate]
Measure = Plugin
Plugin = RunCommand
OutputType = ANSI
StartInFolder = #@#
FinishAction = !CommandMeasure Script "StartCSS()"

[ThemeFolderView]
Measure = Plugin
Plugin = FileView
Path = #ROOTCONFIGPATH#Themes
ShowDotDot = 0
ShowFolder = 1
ShowFile = 0
FinishAction = [!UpdateMeasure ThemeFolderCount][!UpdateMeasure ThemeFolderName][!CommandMeasure Script "UpdateTheme()"]

[ThemeFolderCount]
Measure = Plugin
Plugin = FileView
Path = [ThemeFolderView]
Type = FolderCount

[ThemeFolderName]
Measure = Plugin
Plugin = FileView
Path = [ThemeFolderView]
Type = FileName
Index = 1
IgnoreCount = 1

[FileView]
Measure = Plugin
Plugin = FileView
Path = #@#Backup
ShowDotDot = 0
ShowFolder = 0
FinishAction = !CommandMeasure Script "UpdateInitStatus()"

[FileCount]
Measure = Plugin
Plugin = FileView
Path = [FileView]
Type = FileCount

[FileName]
Measure = Plugin
Plugin = FileView
Path = [FileView]
Type = FileName
Index = 1
IgnoreCount = 1

[CSSFileView]
Measure = Plugin
Plugin = FileView
ShowDotDot = 0

[CSSFileName]
Measure = Plugin
Plugin = FileView
Path = [CSSFileView]
Type = FilePath
Index = 1
IgnoreCount = 1


[Background]
Meter = Shape
Shape = Rectangle 10,10,600,700,5 | StrokeWidth 0 | Fill Color f7f9f9

[Theme]
Meter = String
Text = Theme:
FontFace = Bahnschrift
FOntSize = 13
FontColor = 282828
X = 30
Y = 30
AntiAlias = 1
FontWeight = 600

[ThemeBack_Disabled]
Meter = String
Text = [\xf191]
FontFace = Font Awesome 5 Free
FontSize = 18
FontColor = 909090
AntiAlias = 1
X = 10R
Y = -5r

[ThemeBack]
Meter = String
MeterStyle = ThemeBack_Disabled
FontColor = 282828
X = r
Y = r
MouseOverAction = [!SetOption #CURRENTSECTION# FontColor 8a4fff][!UpdateMeter #CURRENTSECTION#][!Redraw]
MouseLeaveAction = [!SetOption #CURRENTSECTION# FontColor 282828][!UpdateMeter #CURRENTSECTION#][!Redraw]
LeftMouseUpAction = !CommandMeasure Script ThemeChange(-1)
Hidden = 1

[ThemeNext_Disabled]
Meter = String
Text = [\xf152]
FontFace = Font Awesome 5 Free
FontSize = 18
FontColor = 909090
AntiAlias = 1
X = 130
Y = r

[ThemeNext]
Meter = String
MeterStyle = ThemeNext_Disabled
FontColor = 282828
X = r
Y = r
MouseOverAction = [!SetOption #CURRENTSECTION# FontColor 8a4fff][!UpdateMeter #CURRENTSECTION#][!Redraw]
MouseLeaveAction = [!SetOption #CURRENTSECTION# FontColor 282828][!UpdateMeter #CURRENTSECTION#][!Redraw]
LeftMouseUpAction = !CommandMeasure Script ThemeChange(1)
Hidden = 1

[ThemeName]
Meter = String
Text = #CurrentTheme#
X = 170
Y = 30
FontFace = Bahnschrift
FOntSize = 13
FontColor = 282828
AntiAlias = 1
ClipString = 1
W = 400

[ThemeRunCommand]
Measure = Plugin
Plugin = RunCommand
OutputType = ANSI
StartInFolder = #ROOTCONFIGPATH#Themes

[ReplaceColorsMeasure]
Measure = Calc
IfCondition = #Replace_Colors# = 1
IfTrueAction = [!SetOption ReplaceColorsToggle Prefix "[\xf14a] Replace colors"]
IfFalseAction = [!SetOption ReplaceColorsToggle Prefix "[\xf0c8] Replace colors"][!SetOptionGroup ColorBox Color "Fill Color 909090"][!SetOptionGroup ColorBox LeftMouseUpAction ""][!SetOptionGroup ColorBoxText FontColor "909090"]

[ReplaceColorsToggle]
Meter = String
Text =
InlinePattern = ^(.)
InlineSetting = Face | Font Awesome 5 Free
FontFace = Bahnschrift
FOntSize = 13
FontColor = 282828
X = 30
Y = 80
AntiAlias = 1
LeftMouseUpAction = [!WriteKeyValue Variables Replace_Colors "(1 - #Replace_Colors#)"][!Refresh]

[InjectCSSMeasure]
Measure = Calc
IfCondition = #Inject_CSS# = 1
IfTrueAction = !SetOption InjectCSSToggle Prefix "[\xf14a] Inject CSS"
IfFalseAction = !SetOption InjectCSSToggle Prefix "[\xf0c8] Inject CSS"

[InjectCSSToggle]
Meter = String
Text =
InlinePattern = ^(.)
InlineSetting = Face | Font Awesome 5 Free
FontFace = Bahnschrift
FOntSize = 13
FontColor = 282828
Text =
X = 20R
Y = r
LeftMouseUpAction = [!WriteKeyValue Variables Inject_CSS "(1 - #Inject_CSS#)"][!Refresh]
AntiAlias = 1

[HideAdsMeasure]
Measure = Calc
IfCondition = #Hide_Ads# = 1
IfTrueAction = !SetOption HideAdsToggle Prefix "[\xf14a] Hide ads"
IfFalseAction = !SetOption HideAdsToggle Prefix "[\xf0c8] Hide ads"

[HideAdsToggle]
Meter = String
MeterStyle = InjectCSSToggle
Y = r
LeftMouseUpAction = [!WriteKeyValue Variables Hide_Ads "(1 - #Hide_Ads#)"][!Refresh]

[ButtonStyle]
Y = 650
Shape = Rectangle 0,0,120,40,20 | StrokeWidth 1.25 | Stroke Color 8a4fff | Extend Color
Color = Fill Color 00000000
MouseOverAction = [!SetOption #CURRENTSECTION# Color "Fill Color 8a4fff"][!UpdateMeter #CURRENTSECTION#][!SetOption #CURRENTSECTION#Text FontColor f7f9f9][!UpdateMeter #CURRENTSECTION#Text][!Redraw]
MouseLeaveAction = [!SetOption #CURRENTSECTION# Color "Fill Color 00000000"][!UpdateMeter #CURRENTSECTION#][!SetOption #CURRENTSECTION#Text FontColor 8a4fff][!UpdateMeter #CURRENTSECTION#Text][!Redraw]
HIdden = 1

[ButtonTextStyle]
FontFace = Bahnschrift
FontWeight = 600
FontSize = 14
StringAlign = CenterCenter
X = 60r
Y = 671
AntiAlias = 1
FontColor = 8a4fff
HIdden = 1

[BackupButton]
Meter = Shape
MeterStyle = ButtonStyle
X = 30
LeftMouseUpAction = !CommandMeasure "Backup" "Run"
Group = BackupButton

[BackupButtonText]
Meter = String
MeterStyle = ButtonTextStyle
Text = Backup
Group = BackupButton

[RestoreButton]
Meter = Shape
MeterStyle = ButtonStyle
X = 30
LeftMouseUpAction = !CommandMeasure "Restore" "Run"
Group = BackupButton_Disabled

[RestoreButtonText]
Meter = String
MeterStyle = ButtonTextStyle
Text = Restore
Group = BackupButton_Disabled

[ClearBackupButton]
Meter = Shape
MeterStyle = ButtonStyle
X = 170
Shape = Rectangle 0,0,135,40,20 | StrokeWidth 1.25 | Stroke Color FF3030 | Extend Color
MouseOverAction = [!SetOption #CURRENTSECTION# Color "Fill Color FF3030  "][!UpdateMeter #CURRENTSECTION#][!SetOption #CURRENTSECTION#Text FontColor f7f9f9][!UpdateMeter #CURRENTSECTION#Text][!HideMeterGroup PopupClearBackup][!ShowMeterGroup PopupClearBackup][!Redraw]
MouseLeaveAction = [!SetOption #CURRENTSECTION# Color "Fill Color 00000000"][!UpdateMeter #CURRENTSECTION#][!SetOption #CURRENTSECTION#Text FontColor FF3030][!UpdateMeter #CURRENTSECTION#Text][!HideMeterGroup PopupClearBackup][!HideMeterGroup PopupClearBackup][!Redraw]
LeftMouseUpAction = !CommandMeasure "ClearBackup" "Run"
Group = BackupButton_Disabled

[ClearBackupButtonText]
Meter = String
MeterStyle = ButtonTextStyle
Text = Clear backup
X = 67.5r
FontColor = FF3030
Group = BackupButton_Disabled

[EditCSSButton]
Meter = Shape
MeterStyle = ButtonStyle
X = 330
LeftMouseUpAction = ["#ROOTCONFIGPATH#Themes/#CurrentTheme#/user.css"]
Group =
Hidden = 0

[EditCSSButtonText]
Meter = String
MeterStyle = ButtonTextStyle
Text = Edit CSS
Group =
Hidden = 0

[ApplyButton]
Meter = Shape
MeterStyle = ButtonStyle
X = 470
LeftMouseUpAction = !CommandMeasure "Script" "StartMod()"
Group = ApplyButton

[ApplyButtonText]
Meter = String
MeterStyle = ButtonTextStyle
Text = Apply
Group = ApplyButton

[ColorBoxStyle]
X = 25R
Y = r
Shape = Rectangle 0,0,120,35,8 | StrokeWidth 0 | Extend Color
Group = ColorBox

[TextStyle]
X = 25R
Y = r
W = 120
ClipstringW = 120
Clipstring = 2
StringAlign = LeftBottom
FontFace = Bahnschrift
FontSize = 13
FontWeight = 400
AntiAlias = 1
FontColor = 282828
Group = ColorBoxText

[ShadowStyle]
ImageName = #@#Shadow.png
X = 15R
Y = r

[Text1]
Meter = String
X = 30
Y = 160
MeterStyle = TextStyle

[Text2]
Meter = String
MeterStyle = TextStyle

[Text3]
Meter = String
MeterStyle = TextStyle

[Text4]
Meter = String
MeterStyle = TextStyle

[Shadow1]
Meter = Image
X = 25
Y = -8r
MeterStyle = ShadowStyle

[Shadow2]
Meter = Image
MeterStyle = ShadowStyle

[Shadow3]
Meter = Image
MeterStyle = ShadowStyle

[Shadow4]
Meter = Image
MeterStyle = ShadowStyle

[Box1]
Meter=Shape
X = 30
Y = 18r
MeterStyle = ColorBoxStyle

[Box2]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box3]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box4]
Meter=Shape
MeterStyle = ColorBoxStyle

[Text5]
Meter = String
X = 30
Y = 65R
MeterStyle = TextStyle

[Text6]
Meter = String
MeterStyle = TextStyle

[Text7]
Meter = String
MeterStyle = TextStyle

[Text8]
Meter = String
MeterStyle = TextStyle

[Shadow5]
Meter = Image
X = 25
Y = -8r
MeterStyle = ShadowStyle

[Shadow6]
Meter = Image
MeterStyle = ShadowStyle

[Shadow7]
Meter = Image
MeterStyle = ShadowStyle

[Shadow8]
Meter = Image
MeterStyle = ShadowStyle

[Box5]
Meter=Shape
X = 30
Y = 18r
MeterStyle = ColorBoxStyle

[Box6]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box7]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box8]
Meter=Shape
MeterStyle = ColorBoxStyle

[Text9]
Meter = String
X = 30
Y = 65R
MeterStyle = TextStyle

[Text10]
Meter = String
MeterStyle = TextStyle

[Text11]
Meter = String
MeterStyle = TextStyle

[Text12]
Meter = String
MeterStyle = TextStyle

[Shadow9]
Meter = Image
X = 25
Y = -8r
MeterStyle = ShadowStyle

[Shadow10]
Meter = Image
MeterStyle = ShadowStyle

[Shadow11]
Meter = Image
MeterStyle = ShadowStyle

[Shadow12]
Meter = Image
MeterStyle = ShadowStyle

[Box9]
Meter=Shape
X = 30
Y = 18r
MeterStyle = ColorBoxStyle

[Box10]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box11]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box12]
Meter=Shape
MeterStyle = ColorBoxStyle

[Text13]
Meter = String
X = 30
Y = 65R
MeterStyle = TextStyle

[Text14]
Meter = String
MeterStyle = TextStyle

[Text15]
Meter = String
MeterStyle = TextStyle

[Text16]
Meter = String
MeterStyle = TextStyle

[Shadow13]
Meter = Image
X = 25
Y = -8r
MeterStyle = ShadowStyle

[Shadow14]
Meter = Image
MeterStyle = ShadowStyle

[Shadow15]
Meter = Image
MeterStyle = ShadowStyle

[Shadow16]
Meter = Image
MeterStyle = ShadowStyle

[Box13]
Meter=Shape
X = 30
Y = 18r
MeterStyle = ColorBoxStyle

[Box14]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box15]
Meter=Shape
MeterStyle = ColorBoxStyle

[Box16]
Meter=Shape
MeterStyle = ColorBoxStyle

[PercentBar]
Meter=Shape
X = 30
Y = 565
Shape = Rectangle 0,0,560,4,2 | StrokeWidth 0 | Fill Color 50505050
Shape2 = Rectangle 0,0,(560*[Script:UpdatePercent()]),4,2 | StrokeWidth 0 | Fill Color 8a4fff
DynamicVariables = 1

[Status]
Meter = String
MeasureName = Script
FontFace = Source Sans Pro
FontWeight = 300
FOntSize = 15
X = 30
Y = 20r
FontCOlor =505050
AntiAlias = 1
InlinePattern = Updating (.*)
InlineSetting = Weight | 500
InlinePattern2 = Unzipping (.*)
InlineSetting2 = Weight | 500
InlinePattern3 = Mod succeeded
InlineSetting3 = Weight | 500

[PopupClearBackup]
Meter = Shape
X = (170+67.5)
Y = 630
Shape = Rectangle -180,0,360,-125,5 | StrokeWidth 0 | Fill Color FF3030
Shape2 = Rectangle -10,0,20,20,3 | StrokeWidth 0 | Fill Color FF3030 | Rotate 45 | Offset 0,(-20/sqrt(2))
Group = PopupClearBackup
Hidden = 1

[PopupClearBackupIcon]
Meter = String
Text = [\xf057]
FontFace = Font Awesome 5 Free
FontSize = 40
X = -170r
Y = (630-57.5)
StringAlign = LeftCenter
AntiAlias = 1
FontColor = FFFFFF
Group = PopupClearBackup
Hidden = 1

[PopupClearBackupText]
Meter = String
Text = Before clearing backup and backing up again, make sure you have restored or re-installed Spotify to original state
FontFace = Bahnschrift
FontWeight = 400
FontSize = 13
StringAlign = LeftBottom
ClipStringW = 250
ClipString = 2
X = 10R
Y = 620
AntiAlias = 1
FontColor = FFFFFF
Group = PopupClearBackup
Hidden = 1
